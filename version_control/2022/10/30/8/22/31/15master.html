<p>线上部署：</p>
<p>1.打包：</p>
<p>后端打包：
先clean再install，找到target下的jar包上传到服务器。
<img src="https://img.kancloud.cn/a4/3f/a43f8a044051168614c683e459a1976f_1198x953.png" alt="alt icecms"/></p>
<p><img src="https://img.kancloud.cn/07/21/0721b6917d118f969f054cf5761aa786_684x933.png" alt="alt icecms"/>
<img src="https://img.kancloud.cn/ba/be/babe4e1b844456b328195cfc1c7116d3_804x350.png" alt="alt icecms"/>
上传后执行：
nohup java -jar project-fast.jar —spring.profiles.active=prod &amp;
即可运行后端服务。
uniapp H5打包：
<img src="![alt icecms](https://img.kancloud.cn/36/16/361688d3f3e6619fd02adf124fedf1c8_714x936.png" alt="alt icecms"/>)
打包前记得utils/config.js下配置你的线上域名
<img src="![alt icecms](https://img.kancloud.cn/fc/6e/fc6ebeee5f3b7335546e7769b53c085c_827x294.png" alt="alt icecms"/>)
后台管理系统打包：
<img src="![alt icecms](https://img.kancloud.cn/ea/69/ea69f29bcfbb724a098ee7c1ff5f3d97_1347x762.png" alt="alt icecms"/>)
<img src="![alt icecms](https://img.kancloud.cn/e0/76/e0764b57a270772ccc4ee6274b16c5d2_1237x630.png" alt="alt icecms"/>)</p>
<ol>
<li>部署（1）准备几个子域名（按你自己的需要来）</li></ol>
<p>提示：如下的子域名前缀你可以自定义，我只是为了演示。
后端api服务：api.xxx.com （这个必须有）
h5端：h5.xxx.com （如果你不需要h5用户端就不用）
后台管理系统: admin.xxx.com (这个必须有)
去阿里云或者腾讯云用你们公司（注意：如果你上线小程序必须用你公司的域名，h5不要求）已备案的域名申请SSL证书。需要申请的数目按如上要求。申请证书免费。
<img src="![alt icecms](https://img.kancloud.cn/f8/79/f879cbfe32944bd7414e9fb68dc6c9c2_1901x902.png" alt="alt icecms"/>)
（2）安装宝塔</p>
<p>用宝塔部署要快点。本项目暂不支持容器部署。这是只说明宝塔部署。
按照宝塔安装手册要求安装好以后，需要安装nginx，redis，mysql5.7。
还有java运行环境，打开黑窗口执行yum命令安装。不然jar包跑不起来。
安装JDK 1.8 (yum -y install java-1.8.0-openjdk)
然后创建站点
<img src="![alt icecms](https://img.kancloud.cn/3a/12/3a12d6e6c6aa5ec8f8ce4a215584b399_1920x812.png" alt="alt icecms"/>)
下载ssl证书（用nginx版本）并填写
<img src="![alt icecms](https://img.kancloud.cn/e9/1a/e91aa3d4f4feae11a1d770d0a41af5e1_1361x837.png" alt="alt icecms"/>)
对于后端api服务域名api.xxx.com，需要配置nginx，直接看第（3）步。
对于admin.xxx.com和h5.xxx.com，不用配置，只要按如下图指定目录即可。
<img src="![alt icecms](https://img.kancloud.cn/fd/96/fd96eeeb5a7522fc3dc003614aaa1184_910x575.png" alt="alt icecms"/>)
（3）nginx配置
<img src="![alt icecms](https://img.kancloud.cn/d8/d3/d8d3451cfa7d58a2c4b4d29c12acd5ca_636x329.png" alt="alt icecms"/>)
不要直接复制粘贴！！！对应的域名改成你自己的！！！主要就是该location/里面的代理端口。配置完成后，访问：api.xxx.com 出现如图所示即为配置成功。</p>
<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="lang-json"></code></li><li class="L1"><code class="lang-json"><span class="pln">server</span></code></li><li class="L2"><code class="lang-json"><span class="pun">{</span></code></li><li class="L3"><code class="lang-json"><span class="pln">    listen </span><span class="lit">80</span><span class="pun">;</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    listen </span><span class="lit">443</span><span class="pln"> ssl http2</span><span class="pun">;</span></code></li><li class="L5"><code class="lang-json"><span class="pln">    server_name api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">;</span></code></li><li class="L6"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> index index</span><span class="pun">.</span><span class="pln">php index</span><span class="pun">.</span><span class="pln">html index</span><span class="pun">.</span><span class="pln">htm default</span><span class="pun">.</span><span class="pln">php default</span><span class="pun">.</span><span class="pln">htm default</span><span class="pun">.</span><span class="pln">html</span><span class="pun">;</span></code></li><li class="L7"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> root </span><span class="pun">/</span><span class="pln">www</span><span class="pun">/</span><span class="pln">wwwroot</span><span class="pun">/</span><span class="pln">api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">;</span></code></li><li class="L8"><code class="lang-json"></code></li><li class="L9"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">SSL</span><span class="pun">-</span><span class="pln">START SSL</span><span class="pun">相关配置，请勿删除或修改下一行带注释的</span><span class="lit">404</span><span class="pun">规则</span></code></li><li class="L0"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">error_page </span><span class="lit">404</span><span class="pun">/</span><span class="lit">404.html</span><span class="pun">;</span></code></li><li class="L1"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">HTTP_TO_HTTPS_START</span></code></li><li class="L2"><code class="lang-json"><span class="pln">    if </span><span class="pun">(</span><span class="pln">$server_port </span><span class="pun">!~</span><span class="pln"> </span><span class="lit">443</span><span class="pun">){</span></code></li><li class="L3"><code class="lang-json"><span class="pln">        rewrite </span><span class="pun">^(/.*)</span><span class="pln">$ https</span><span class="pun">://</span><span class="pln">$host$1 permanent</span><span class="pun">;</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L5"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">HTTP_TO_HTTPS_END</span></code></li><li class="L6"><code class="lang-json"><span class="pln">    ssl_certificate    </span><span class="pun">/</span><span class="pln">www</span><span class="pun">/</span><span class="pln">server</span><span class="pun">/</span><span class="pln">panel</span><span class="pun">/</span><span class="pln">vhost</span><span class="pun">/</span><span class="pln">cert</span><span class="pun">/</span><span class="pln">api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">/</span><span class="pln">fullchain</span><span class="pun">.</span><span class="pln">pem</span><span class="pun">;</span></code></li><li class="L7"><code class="lang-json"><span class="pln">    ssl_certificate_key    </span><span class="pun">/</span><span class="pln">www</span><span class="pun">/</span><span class="pln">server</span><span class="pun">/</span><span class="pln">panel</span><span class="pun">/</span><span class="pln">vhost</span><span class="pun">/</span><span class="pln">cert</span><span class="pun">/</span><span class="pln">api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">/</span><span class="pln">privkey</span><span class="pun">.</span><span class="pln">pem</span><span class="pun">;</span></code></li><li class="L8"><code class="lang-json"><span class="pln">    ssl_protocols </span><span class="typ">TLSv1</span><span class="pun">.</span><span class="lit">1</span><span class="pln"> </span><span class="typ">TLSv1</span><span class="pun">.</span><span class="lit">2</span><span class="pln"> </span><span class="typ">TLSv1</span><span class="pun">.</span><span class="lit">3</span><span class="pun">;</span></code></li><li class="L9"><code class="lang-json"><span class="pln">    ssl_ciphers EECDH</span><span class="pun">+</span><span class="pln">CHACHA20</span><span class="pun">:</span><span class="pln">EECDH</span><span class="pun">+</span><span class="pln">CHACHA20</span><span class="pun">-</span><span class="pln">draft</span><span class="pun">:</span><span class="pln">EECDH</span><span class="pun">+</span><span class="pln">AES128</span><span class="pun">:</span><span class="pln">RSA</span><span class="pun">+</span><span class="pln">AES128</span><span class="pun">:</span><span class="pln">EECDH</span><span class="pun">+</span><span class="pln">AES256</span><span class="pun">:</span><span class="pln">RSA</span><span class="pun">+</span><span class="pln">AES256</span><span class="pun">:</span><span class="pln">EECDH</span><span class="pun">+</span><span class="lit">3DES</span><span class="pun">:</span><span class="pln">RSA</span><span class="pun">+</span><span class="lit">3DES</span><span class="pun">:!</span><span class="pln">MD5</span><span class="pun">;</span></code></li><li class="L0"><code class="lang-json"><span class="pln">    ssl_prefer_server_ciphers on</span><span class="pun">;</span></code></li><li class="L1"><code class="lang-json"><span class="pln">    ssl_session_cache shared</span><span class="pun">:</span><span class="pln">SSL</span><span class="pun">:</span><span class="lit">10m</span><span class="pun">;</span></code></li><li class="L2"><code class="lang-json"><span class="pln">    ssl_session_timeout </span><span class="lit">10m</span><span class="pun">;</span></code></li><li class="L3"><code class="lang-json"><span class="pln">    add_header </span><span class="typ">Strict</span><span class="pun">-</span><span class="typ">Transport</span><span class="pun">-</span><span class="typ">Security</span><span class="pln"> </span><span class="str">&#34;max-age=31536000&#34;</span><span class="pun">;</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    error_page </span><span class="lit">497</span><span class="pln">  https</span><span class="pun">://</span><span class="pln">$host$request_uri</span><span class="pun">;</span></code></li><li class="L5"><code class="lang-json"></code></li><li class="L6"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">SSL</span><span class="pun">-</span><span class="pln">END</span></code></li><li class="L7"><code class="lang-json"></code></li><li class="L8"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">ERROR</span><span class="pun">-</span><span class="pln">PAGE</span><span class="pun">-</span><span class="pln">START  </span><span class="pun">错误页配置，可以注释、删除或修改</span></code></li><li class="L9"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">error_page </span><span class="lit">404</span><span class="pln"> </span><span class="pun">/</span><span class="lit">404.html</span><span class="pun">;</span></code></li><li class="L0"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">error_page </span><span class="lit">502</span><span class="pln"> </span><span class="pun">/</span><span class="lit">502.html</span><span class="pun">;</span></code></li><li class="L1"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">ERROR</span><span class="pun">-</span><span class="pln">PAGE</span><span class="pun">-</span><span class="pln">END</span></code></li><li class="L2"><code class="lang-json"></code></li><li class="L3"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">PHP</span><span class="pun">-</span><span class="pln">INFO</span><span class="pun">-</span><span class="pln">START  PHP</span><span class="pun">引用配置，可以注释或修改</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> include enable</span><span class="pun">-</span><span class="pln">php</span><span class="pun">-</span><span class="lit">00.conf</span><span class="pun">;</span></code></li><li class="L5"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">PHP</span><span class="pun">-</span><span class="pln">INFO</span><span class="pun">-</span><span class="pln">END</span></code></li><li class="L6"><code class="lang-json"></code></li><li class="L7"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">REWRITE</span><span class="pun">-</span><span class="pln">START URL</span><span class="pun">重写规则引用,修改后将导致面板设置的伪静态规则失效</span></code></li><li class="L8"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> include </span><span class="pun">/</span><span class="pln">www</span><span class="pun">/</span><span class="pln">server</span><span class="pun">/</span><span class="pln">panel</span><span class="pun">/</span><span class="pln">vhost</span><span class="pun">/</span><span class="pln">rewrite</span><span class="pun">/</span><span class="pln">api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">.</span><span class="pln">conf</span><span class="pun">;</span></code></li><li class="L9"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">REWRITE</span><span class="pun">-</span><span class="pln">END</span></code></li><li class="L0"><code class="lang-json"></code></li><li class="L1"><code class="lang-json"><span class="pln">    </span><span class="pun">#禁止访问的文件或目录</span></code></li><li class="L2"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> location </span><span class="pun">~</span><span class="pln"> </span><span class="pun">^/(</span><span class="pln">\.user</span><span class="pun">.</span><span class="pln">ini</span><span class="pun">|</span><span class="pln">\.htaccess</span><span class="pun">|</span><span class="pln">\.git</span><span class="pun">|</span><span class="pln">\.svn</span><span class="pun">|</span><span class="pln">\.project</span><span class="pun">|</span><span class="pln">LICENSE</span><span class="pun">|</span><span class="pln">README</span><span class="pun">.</span><span class="pln">md</span><span class="pun">)</span></code></li><li class="L3"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     return </span><span class="lit">404</span><span class="pun">;</span></code></li><li class="L5"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L6"><code class="lang-json"></code></li><li class="L7"><code class="lang-json"><span class="pln">    </span><span class="pun">#一键申请</span><span class="pln">SSL</span><span class="pun">证书验证目录相关设置</span></code></li><li class="L8"><code class="lang-json"><span class="pln">    location </span><span class="pun">~</span><span class="pln"> \.well</span><span class="pun">-</span><span class="pln">known</span><span class="pun">{</span></code></li><li class="L9"><code class="lang-json"><span class="pln">        allow all</span><span class="pun">;</span></code></li><li class="L0"><code class="lang-json"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L1"><code class="lang-json"></code></li><li class="L2"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> location </span><span class="pun">~</span><span class="pln"> </span><span class="pun">.*</span><span class="pln">\.</span><span class="pun">(</span><span class="pln">gif</span><span class="pun">|</span><span class="pln">jpg</span><span class="pun">|</span><span class="pln">jpeg</span><span class="pun">|</span><span class="pln">png</span><span class="pun">|</span><span class="pln">bmp</span><span class="pun">|</span><span class="pln">swf</span><span class="pun">)</span><span class="pln">$</span></code></li><li class="L3"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     expires      </span><span class="lit">30d</span><span class="pun">;</span></code></li><li class="L5"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     error_log off</span><span class="pun">;</span></code></li><li class="L6"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     access_log </span><span class="pun">/</span><span class="pln">dev</span><span class="pun">/</span><span class="kwd">null</span><span class="pun">;</span></code></li><li class="L7"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L8"><code class="lang-json"></code></li><li class="L9"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> location </span><span class="pun">~</span><span class="pln"> </span><span class="pun">.*</span><span class="pln">\.</span><span class="pun">(</span><span class="pln">js</span><span class="pun">|</span><span class="pln">css</span><span class="pun">)?</span><span class="pln">$</span></code></li><li class="L0"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     expires      </span><span class="lit">12h</span><span class="pun">;</span></code></li><li class="L2"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     error_log off</span><span class="pun">;</span></code></li><li class="L3"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln">     access_log </span><span class="pun">/</span><span class="pln">dev</span><span class="pun">/</span><span class="kwd">null</span><span class="pun">;</span><span class="pln"> </span></code></li><li class="L4"><code class="lang-json"><span class="pln">    </span><span class="pun">#</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L5"><code class="lang-json"><span class="pln">  location </span><span class="pun">/</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="lang-json"><span class="pln">        proxy_pass http</span><span class="pun">://</span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">8080</span><span class="pun">;</span></code></li><li class="L7"><code class="lang-json"><span class="pln">        proxy_set_header X</span><span class="pun">-</span><span class="typ">Forwarded</span><span class="pun">-</span><span class="typ">Proto</span><span class="pln"> $scheme</span><span class="pun">;</span></code></li><li class="L8"><code class="lang-json"><span class="pln">            proxy_set_header X</span><span class="pun">-</span><span class="typ">Forwarded</span><span class="pun">-</span><span class="typ">Port</span><span class="pln"> $server_port</span><span class="pun">;</span></code></li><li class="L9"><code class="lang-json"><span class="pln">            proxy_set_header X</span><span class="pun">-</span><span class="typ">Forwarded</span><span class="pun">-</span><span class="typ">For</span><span class="pln"> $proxy_add_x_forwarded_for</span><span class="pun">;</span></code></li><li class="L0"><code class="lang-json"><span class="pln">            proxy_set_header </span><span class="typ">Upgrade</span><span class="pln"> $http_upgrade</span><span class="pun">;</span></code></li><li class="L1"><code class="lang-json"><span class="pln">            proxy_set_header </span><span class="typ">Connection</span><span class="pln"> </span><span class="str">&#34;upgrade&#34;</span><span class="pun">;</span></code></li><li class="L2"><code class="lang-json"></code></li><li class="L3"><code class="lang-json"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code class="lang-json"><span class="pln">    access_log  </span><span class="pun">/</span><span class="pln">www</span><span class="pun">/</span><span class="pln">wwwlogs</span><span class="pun">/</span><span class="pln">api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">.</span><span class="pln">log</span><span class="pun">;</span></code></li><li class="L5"><code class="lang-json"><span class="pln">    error_log  </span><span class="pun">/</span><span class="pln">www</span><span class="pun">/</span><span class="pln">wwwlogs</span><span class="pun">/</span><span class="pln">api</span><span class="pun">.</span><span class="pln">linfeng</span><span class="pun">.</span><span class="pln">tech</span><span class="pun">.</span><span class="pln">error</span><span class="pun">.</span><span class="pln">log</span><span class="pun">;</span></code></li><li class="L6"><code class="lang-json"><span class="pun">}</span></code></li></ol></pre>
